{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport axios from \"axios\";\nimport queryString from \"query-string\";\nimport base64 from 'base-64';\nimport AsyncStorage from '@react-native-async-storage/async-storage';\nexport var getApi = axios.create({\n  baseURL: \"https://nihwl-dscatalog.herokuapp.com\"\n});\nvar CLIENT_ID = 'dscatalog';\nvar CLIENT_SECRET = 'dscatalog123';\nexport var makeLogin = function makeLogin(info) {\n  var token, headers, result, access_token;\n  return _regeneratorRuntime.async(function makeLogin$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          token = CLIENT_ID + \":\" + CLIENT_SECRET;\n          headers = {\n            Authorization: \"Basic \" + base64.encode(token),\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          };\n          _context.next = 4;\n          return _regeneratorRuntime.awrap(getApi.post('/oauth/token', queryString.stringify(_objectSpread(_objectSpread({}, info), {}, {\n            grant_type: 'password'\n          })), {\n            headers: headers\n          }));\n\n        case 4:\n          result = _context.sent;\n          console.log(result.data);\n          access_token = result.data.access_token;\n          setKeys(\"@token\", access_token);\n\n        case 8:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};\n\nvar setKeys = function setKeys(key, value) {\n  return _regeneratorRuntime.async(function setKeys$(_context2) {\n    while (1) {\n      switch (_context2.prev = _context2.next) {\n        case 0:\n          _context2.prev = 0;\n          _context2.next = 3;\n          return _regeneratorRuntime.awrap(AsyncStorage.setItem(key, value));\n\n        case 3:\n          _context2.next = 8;\n          break;\n\n        case 5:\n          _context2.prev = 5;\n          _context2.t0 = _context2[\"catch\"](0);\n          console.error('Deu merda');\n\n        case 8:\n        case \"end\":\n          return _context2.stop();\n      }\n    }\n  }, null, null, [[0, 5]], Promise);\n};\n\nexport var isAuthenticated = function isAuthenticated() {\n  var token;\n  return _regeneratorRuntime.async(function isAuthenticated$(_context3) {\n    while (1) {\n      switch (_context3.prev = _context3.next) {\n        case 0:\n          _context3.prev = 0;\n          _context3.next = 3;\n          return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"@token\"));\n\n        case 3:\n          token = _context3.sent;\n          console.log('AQUI: ' + token);\n          return _context3.abrupt(\"return\", token ? true : false);\n\n        case 8:\n          _context3.prev = 8;\n          _context3.t0 = _context3[\"catch\"](0);\n          console.error('Deu merda');\n\n        case 11:\n        case \"end\":\n          return _context3.stop();\n      }\n    }\n  }, null, null, [[0, 8]], Promise);\n};\nexport var doLogout = function doLogout() {\n  return _regeneratorRuntime.async(function doLogout$(_context4) {\n    while (1) {\n      switch (_context4.prev = _context4.next) {\n        case 0:\n          try {\n            AsyncStorage.removeItem(\"@token\");\n          } catch (e) {\n            console.error('Deu merda');\n          }\n\n        case 1:\n        case \"end\":\n          return _context4.stop();\n      }\n    }\n  }, null, null, null, Promise);\n};","map":{"version":3,"sources":["C:/Users/Pedro/Desktop/Pasta com outras Pastas/Bootcamp/dscatalog/front-mobile/src/services/index.ts"],"names":["axios","queryString","base64","AsyncStorage","getApi","create","baseURL","CLIENT_ID","CLIENT_SECRET","makeLogin","info","token","headers","Authorization","encode","post","stringify","grant_type","result","console","log","data","access_token","setKeys","key","value","setItem","error","isAuthenticated","getItem","doLogout","removeItem","e"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,WAAP,MAAwB,cAAxB;AACA,OAAOC,MAAP,MAAmB,SAAnB;AACA,OAAOC,YAAP,MAAyB,2CAAzB;AAEA,OAAO,IAAMC,MAAM,GAAGJ,KAAK,CAACK,MAAN,CAAa;AAC/BC,EAAAA,OAAO,EAAE;AADsB,CAAb,CAAf;AAIP,IAAMC,SAAS,GAAG,WAAlB;AACA,IAAMC,aAAa,GAAG,cAAtB;AAOA,OAAO,IAAMC,SAAS,GAAG,SAAZA,SAAY,CAAOC,IAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AACfC,UAAAA,KADe,GACJJ,SADI,SACSC,aADT;AAEfI,UAAAA,OAFe,GAEL;AACZC,YAAAA,aAAa,aAAWX,MAAM,CAACY,MAAP,CAAcH,KAAd,CADZ;AAEZ,4BAAgB;AAFJ,WAFK;AAAA;AAAA,2CAOAP,MAAM,CAACW,IAAP,CAAY,cAAZ,EAA4Bd,WAAW,CAACe,SAAZ,iCAA2BN,IAA3B;AAAiCO,YAAAA,UAAU,EAAE;AAA7C,aAA5B,EAAwF;AAAEL,YAAAA,OAAO,EAAPA;AAAF,WAAxF,CAPA;;AAAA;AAOfM,UAAAA,MAPe;AAQrBC,UAAAA,OAAO,CAACC,GAAR,CAAYF,MAAM,CAACG,IAAnB;AAEQC,UAAAA,YAVa,GAUIJ,MAAM,CAACG,IAVX,CAUbC,YAVa;AAYrBC,UAAAA,OAAO,CAAC,QAAD,EAAWD,YAAX,CAAP;;AAZqB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAlB;;AAeP,IAAMC,OAAO,GAAG,SAAVA,OAAU,CAAOC,GAAP,EAAoBC,KAApB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAEFtB,YAAY,CAACuB,OAAb,CAAqBF,GAArB,EAA0BC,KAA1B,CAFE;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAIRN,UAAAA,OAAO,CAACQ,KAAR,CAAc,WAAd;;AAJQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAhB;;AAQA,OAAO,IAAMC,eAAe,GAAG,SAAlBA,eAAkB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2CAEHzB,YAAY,CAAC0B,OAAb,CAAqB,QAArB,CAFG;;AAAA;AAEjBlB,UAAAA,KAFiB;AAGvBQ,UAAAA,OAAO,CAACC,GAAR,CAAY,WAAWT,KAAvB;AAHuB,4CAIhBA,KAAK,GAAG,IAAH,GAAU,KAJC;;AAAA;AAAA;AAAA;AAOvBQ,UAAAA,OAAO,CAACQ,KAAR,CAAc,WAAd;;AAPuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAxB;AAYP,OAAO,IAAMG,QAAQ,GAAG,SAAXA,QAAW;AAAA;AAAA;AAAA;AAAA;AACpB,cAAI;AACA3B,YAAAA,YAAY,CAAC4B,UAAb,CAAwB,QAAxB;AACH,WAFD,CAEE,OAAOC,CAAP,EAAU;AACRb,YAAAA,OAAO,CAACQ,KAAR,CAAc,WAAd;AAEH;;AANmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,CAAjB","sourcesContent":["import axios from \"axios\";\r\nimport queryString from \"query-string\"\r\nimport base64 from 'base-64'\r\nimport AsyncStorage from '@react-native-async-storage/async-storage'\r\n\r\nexport const getApi = axios.create({\r\n    baseURL: \"https://nihwl-dscatalog.herokuapp.com\"\r\n})\r\n\r\nconst CLIENT_ID = 'dscatalog'\r\nconst CLIENT_SECRET = 'dscatalog123'\r\n\r\ninterface AuthProps {\r\n    username: string;\r\n    password: string;\r\n}\r\n\r\nexport const makeLogin = async (info: AuthProps) => {\r\n    const token = `${CLIENT_ID}:${CLIENT_SECRET}`\r\n    const headers = {\r\n        Authorization: `Basic ${base64.encode(token)}`,\r\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n    }\r\n\r\n    const result = await getApi.post('/oauth/token', queryString.stringify({ ...info, grant_type: 'password' }), { headers })\r\n    console.log(result.data)\r\n\r\n    const { access_token } = result.data\r\n\r\n    setKeys(\"@token\", access_token)\r\n}\r\n\r\nconst setKeys = async (key: string, value: string) => {\r\n    try {\r\n        await AsyncStorage.setItem(key, value)\r\n    } catch (e) {\r\n        console.error('Deu merda')\r\n    } \r\n}\r\n\r\nexport const isAuthenticated = async () => {\r\n    try {\r\n        const token = await AsyncStorage.getItem(\"@token\")\r\n        console.log('AQUI: ' + token)\r\n        return token ? true : false \r\n\r\n    } catch (e) {\r\n        console.error('Deu merda')\r\n\r\n    } \r\n}\r\n\r\nexport const doLogout = async () => {\r\n    try {\r\n        AsyncStorage.removeItem(\"@token\")\r\n    } catch (e) {\r\n        console.error('Deu merda')\r\n\r\n    }\r\n    \r\n}"]},"metadata":{},"sourceType":"module"}